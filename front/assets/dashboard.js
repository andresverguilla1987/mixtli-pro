import * as API from './adapter.js';const $=q=>document.querySelector(q);$('#btnLogout').onclick=()=>{API.Token.token='';location.href='index.html';};$('#btnUpload').onclick=async()=>{const f=$('#file').files[0];if(!f)return alert('Selecciona un archivo');const ttl=Number($('#ttl').value||14);$('#pct').textContent='0%';$('#bar').style.width='0%';try{const pre=await API.presign(f,ttl);const put=await API.putToBucket(pre.putUrl,f,(l,t)=>{const p=t?Math.round(l*100/t):0;$('#pct').textContent=p+'%';$('#bar').style.width=p+'%';});await API.complete(pre.uploadId,put.etag);const link=await API.getLink(pre.uploadId);$('#shareUrl').value=link.url;$('#debug').textContent=JSON.stringify({uploadId:pre.uploadId,etag:put.etag,link},null,2);const to=$('#emailTo').value.trim();if(to){await API.sendEmail(pre.uploadId,to,$('#emailMsg').value);$('#debug').textContent+='\nEmail enviado a '+to;}}catch(e){$('#debug').textContent=e.message;}};$('#btnCopy').onclick=async()=>{try{await navigator.clipboard.writeText($('#shareUrl').value);}catch{}};