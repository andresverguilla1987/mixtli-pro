
<!doctype html><html lang="es"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Mixtli — Archivos</title><link rel="stylesheet" href="/assets/uploader.css"/></head><body><header><h1>Mixtli — Archivos del bucket</h1><p>Listados desde el backend usando AWS SDK v3.</p><nav><a href="/uploader.html">Uploader</a><a href="/files.html" class="active">Archivos</a></nav></header><main><section class="card"><div class="row"><label>Prefijo</label><input id="prefix" value="uploads/"/><button id="reload" class="secondary">Actualizar</button></div><table id="tbl"><thead><tr><th>Archivo (key)</th><th>Tamaño</th><th>Modificado</th><th>Acciones</th></tr></thead><tbody></tbody></table></section></main><script>async function fetchList(){const prefix=document.getElementById('prefix').value;const res=await fetch(`/api/uploads/list?prefix=${encodeURIComponent(prefix)}`);const data=await res.json();const tbody=document.querySelector('#tbl tbody');tbody.innerHTML='';const items=data.items||[];for(const it of items){const tr=document.createElement('tr');const size=(Number(it.size)||0);const sizeMB=(size/1024/1024).toFixed(2)+' MB';const d=it.lastModified?new Date(it.lastModified):null;const when=d?d.toLocaleString():'';const openUrl=it.urlPublic||`/api/uploads/sign-get?key=${encodeURIComponent(it.key)}&expiresIn=3600`;const btnOpen=it.urlPublic?`<a href="${openUrl}" target="_blank">Abrir</a>`:`<a href="${openUrl}" target="_blank">Abrir (firmado)</a>`;tr.innerHTML=`<td class="mono">${it.key}</td><td>${sizeMB}</td><td>${when}</td><td>${btnOpen}</td>`;tbody.appendChild(tr);}}</script><script>document.getElementById('reload').addEventListener('click',fetchList);fetchList();</script></body></html>
