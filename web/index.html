<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mixtli Web</title>
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#0f172a">
</head>
<body>
  <main>
    <h1>Mixtli Web PWA</h1>
    <p>API health: <span id="health">checking...</span></p>
    <button id="ping">Probar /api/echo</button>
    <pre id="out"></pre>
    <p><a href="http://localhost:9000" target="_blank">Swagger UI</a></p>
  </main>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/sw.js');
    }
    async function checkHealth() {
      try {
        const res = await fetch('http://localhost:10000/api/health');
        const j = await res.json();
        document.getElementById('health').textContent = j.status + ' (' + Math.round(j.uptime) + 's)';
      } catch (e) {
        document.getElementById('health').textContent = 'down';
      }
    }
    checkHealth();
    document.getElementById('ping').onclick = async () => {
      const res = await fetch('http://localhost:10000/api/echo', {
        method: 'POST', headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ hola: 'mixtli' })
      });
      document.getElementById('out').textContent = JSON.stringify(await res.json(), null, 2);
    };
  </script>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif; background:#0f172a; color:#e2e8f0; margin:0; }
    main { max-width: 720px; margin: 48px auto; padding: 0 16px; }
    button { padding: 8px 12px; border: none; border-radius: 8px; }
    pre { background: #111827; padding: 12px; border-radius: 8px; overflow:auto; }
    a { color: #93c5fd; }
  </style>
</body>
</html>
